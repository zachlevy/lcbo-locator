var root = "http://lcboapi.com";
var query = "/products/372078/stores?per_page=100";

function getLocations (url) {
	console.log("ajax fires at: " + url);
	$.ajax({
        url: url,
        dataType: 'json',
        success: function(response){
			console.log("ajax success");
			//createLocator(parseLCBO(response.result));
			console.log(response);
		}
	});
}

function createLocator (url) {
	//console.log("createLocator: " + locations);
  $('#map-container').storeLocator(
    {
      'dataType': 'json',
      'dataLocation': url,
      'slideMap' : false,
      'defaultLoc': true,
      'defaultLat': '43.655088',
      'defaultLng' : '-79.388349',
      'lengthUnit' : 'km',
      'zoomLevel': 9,
      'storeLimit' : -1,
    }
  );
}

/*
function parseLCBO (stores) {
	var locations = [];
	for (i = 0; i < stores.length; i++) {
		store = {
			"id": i + 1,
			"name": stores[i].name,
			"lat": stores[i].latitude,
			"lng": stores[i].longitude,
			"address": stores[i].address_line_1,
			"address2": stores[i].address_line_2,
			"city": stores[i].city,
			"state": "ON",
			"postal": stores[i].postal_code,
			"phone": stores[i].telephone,
		};
		console.log(store);
		locations.push(store);
	}
	return locations;
}
*/

$(function() {
	console.log("start");
	createLocator("http://lcbo.sagemixology.com/getlcbo.php");


	//var storesTotal = [534, 572, 9, 3, 6, 8, 639, 420, 18, 19, 15, 2, 14, 295, 511, 341, 214, 528, 411, 512, 10, 568, 333, 614, 483, 149, 677, 532, 636, 217, 415, 12, 279, 7, 17, 457, 426, 4, 650, 20, 11, 452, 360, 164, 186, 1, 13, 207, 234, 320, 366, 485, 5, 553, 398, 642, 697, 253, 627, 16, 408, 643, 163, 218, 355, 425, 618, 195, 185, 362, 228, 546, 182, 458, 523, 436, 346, 637, 698, 564, 505, 242, 542, 700, 444, 269, 632, 385, 623, 635, 584, 329, 536, 590, 371, 397, 383, 416, 321, 494, 580, 198, 619, 428, 248, 703, 601, 629, 555, 183, 334, 390, 533, 179, 640, 353, 486, 171, 445, 365, 470, 265, 148, 434, 477, 437, 456, 776, 156, 311, 631, 404, 255, 201, 630, 573, 641, 771, 599, 551, 191, 612, 566, 226, 497, 453, 695, 391, 203, 188, 297, 481, 432, 529, 587, 237, 418, 145, 378, 101, 467, 152, 90, 326, 386, 124, 545, 23, 250, 446, 190, 522, 563, 571, 249, 47, 143, 465, 392, 233, 165, 298, 25, 361, 168, 252, 221, 634, 53, 462, 21, 340, 209, 263, 51, 401, 495, 325, 48, 509, 586, 706, 33, 139, 605, 489, 583, 312, 596, 543, 95, 344, 229, 419, 52, 288, 268, 73, 382, 22, 461, 611, 406, 562, 59, 544, 373, 28, 381, 160, 559, 345, 187, 24, 617, 44, 43, 224, 549, 417, 115, 293, 116, 267, 430, 88, 93, 702, 491, 450, 82, 254, 79, 513, 281, 429, 581, 594, 244, 609, 579, 175, 299, 313, 354, 471, 39, 194, 302, 35, 31, 306, 238, 45, 74, 107, 358, 343, 468, 259, 369, 530, 64, 296, 558, 222, 205, 469, 276, 305, 181, 317, 608, 560, 644, 261, 227, 60, 77, 537, 482, 380, 626, 561, 570, 169, 199, 260, 510, 448, 472, 102, 142, 331, 307, 621, 240, 504, 339, 247, 289, 541, 30, 527, 178, 284, 231, 219, 271, 136, 610, 130, 300, 273, 65, 413, 200, 548, 239, 364, 27, 607, 318, 403, 615, 393, 192, 26, 575, 310, 251, 264, 518, 414, 622, 516, 275, 176, 282, 438, 440, 449, 62, 223, 593, 502, 474, 57, 402, 274, 454, 347, 146, 270, 582, 29, 330, 447, 550, 399, 210, 135, 535, 106, 84, 557, 374, 196, 216, 174, 80, 213, 208, 96, 172, 606, 97, 294, 336, 478, 328, 277, 105, 232, 410, 350, 595, 514, 319, 138, 323, 591, 517, 133, 613, 476, 154, 567, 131, 389, 159, 475, 503, 167, 40, 459, 113, 202, 283, 246, 46, 161, 377, 290, 348, 603, 337, 61, 427, 314, 110, 111, 235, 520, 498, 71, 352, 94, 433, 439, 492, 460, 423, 322, 574, 479, 604, 72, 126, 363, 54, 387, 258, 442, 316, 144, 372, 89, 266, 81, 55, 70, 409, 193, 597, 488, 132, 588, 301, 197, 85, 153, 278, 42, 351, 119, 524, 166, 490, 286, 158, 34, 367, 32, 455, 539, 569, 407, 496, 576, 56, 556, 395, 141, 36, 638, 370, 50, 531, 120, 211, 287, 507, 388, 103, 499, 109, 521, 157, 304, 405, 431, 394, 412, 699, 212, 552, 324, 256, 236, 645, 327, 262, 243, 515, 37, 526, 547, 384, 538, 368, 38, 118, 41, 140, 400, 598, 578, 443, 565, 422, 127, 589, 303, 624, 99, 694, 241, 125, 441, 435, 121, 108, 225, 540, 49, 309, 308, 375, 487, 76, 466, 67, 98, 123, 78, 349, 104, 83, 421, 506, 280, 92, 451, 519, 134, 63, 359, 484, 91, 473, 162, 128, 58, 117, 338, 75, 66, 184, 189, 577, 112, 272, 463, 204, 122, 151, 220, 173, 464, 424, 245, 129, 493, 147, 332, 616, 155, 602, 501, 180, 335, 170, 291, 379, 87, 480, 69, 86, 285, 315, 257, 114, 292, 68, 230, 376, 137];
	//console.log("storesTotal: " + storesTotal.length);
});